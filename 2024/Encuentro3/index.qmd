---
title: "Introducción a Quarto®"
subtitle: "Encuentro 3"
author: "Christian Ballejo"
format: 
  revealjs:
    width: 1600
    height: 900
    slide-number: true
    theme: simple
    css: styles.css
    logo: logo_INE.PNG
    footer: "Instituto Nacional de Epidemiología"
editor: source
---

```{r setup, include=F}
library(quarto)
library(fontawesome)
library(tidyverse)
```

## Qué es Quarto®?

<br>

> **Quarto® es un sistema de publicación científica y técnica de código abierto construido sobre [Pandoc](https://pandoc.org/)** [^1]

[^1]: conversor de documentos libre y de código abierto, mayormente usado como una herramienta de escritura (especialmente por académicos) ver en [Wikipedia](https://es.wikipedia.org/wiki/Pandoc)

. . .

> Mezcla texto narrativo y código para producir resultados con un formato elegante en documentos, tableros interactivos, páginas web, publicaciones de blogs, libros y más.

. . .

> Es independiente del lenguaje R (incluso trabaja con otros lenguajes como Python y Julia).

## Comunicar como parte de programar

<br>

![](images/Captura1.PNG){fig-align="center"}

## RMarkdown de Rstudio

-   Desarrollo del paquete **knitr** en 2011
-   Desarrollo de **RMarkdown** en 2014

![](images/Captura2.PNG){.absolute top="300" left="150" width="1100"}

## `knitr` + `rmarkdown` = `Quarto`

10 años de experiencia en `knitr` + `rmarkdown` se volcaron al desarrollo de Quarto.

![](images/Captura3.PNG){.absolute top="250" left="100" width="1200"}

## Como funciona Quarto?

<br>

Quarto usa `knitr` como motor para ejecutar código y generar una salida temporal.

El archivo temporal se procesa mediante los filtros **Lua** de `Pandoc` y `Quarto` + `Bootstrap CSS` para **HTML** o `LaTeX` para **PDF** y se convierte a un formato de salida final.

Los filtros Lua escritos por desarrolladores de `R`/`Python`/`Julia` son intercambiables entre formatos.

Quarto además incluye soporte nativo para `Observable JS`, un conjunto de mejoras a JavaScript básico creado por *Mike Bostock* (también autor de `D3`).

Observable JS se distingue por su tiempo de ejecución reactivo, que es especialmente adecuado para la exploración y el análisis de datos interactivos.

## Ejemplo interactivo con Observable JS

<br>

Conversor de temperatura de ℃ a ℉

<br>

```{ojs}
viewof temp = Inputs.range([0, 99], {step: 1, value: 0, label: htl.html`Temp. &#x2103;`})
```

<br>\
Celsius = \${d3.format(".0f")(temp)}℃ y Fahrenheit = \${d3.format(".1f")(temp \* 9/5 + 32)}℉.

. . . 

<br>
````code
```{{ojs}}
viewof temp = Inputs.range([0, 99], {step: 1, value: 0, label: htl.html`Temp. &#x2103;`})
```
Celsius = \${d3.format(".0f")(temp)}℃ y Fahrenheit = \${d3.format(".1f")(temp \* 9/5 + 32)}℉.

````


## Entonces, ¿qué es Quarto?

> Quarto es una interfaz de *línea de comandos* (**CLI**) que representa formatos de texto sin formato (**.qmd**, .rmd, .md) o formatos mixtos (**.ipynb**/Jupyter notebook) en informes estáticos *PDF*/*Word*/*HTML*, *libros*, *sitios web*, *presentaciones* y más.

```{py}
#| eval: false
#| echo: true
#| code-line-numbers: "|1|4|10"
cballejo$ quarto --help

  Usage:   quarto
  Version: 1.4.553

  Description:
    Quarto CLI

  Options:
    -h, --help     - Show this help.                            
    -V, --version  - Show the version number for this program.  

  Commands:
    render          [input] [args...]   - Render input file(s) to various document types.            
    preview         [file] [args...]    - Render and preview a document or website project.          
    serve           [input]             - Serve a Shiny interactive document.                        
    create-project  [dir]               - Create a project for rendering multiple documents          
    convert         <input>             - Convert documents to alternate representations.            
    pandoc          [args...]           - Run the version of Pandoc embedded within Quarto.          
    run             [script] [args...]  - Run a TypeScript, R, Python, or Lua script.                
    install         <type> [target]     - Installs an extension or global dependency.                
    publish         [provider] [path]   - Publish a document or project. Available providers include:
    check           [target]            - Verify correct functioning of Quarto installation.         
    help            [command]           - Show this help or the help of a sub-command.    
```

## Software Quarto

<br>

-   El sitio web de `Quarto` es <https://quarto.org/>

-   La **versión actual** es 1.4.553 (Windows) del 3/4/2024

-   La **guía oficial** se puede encontrar en <https://quarto.org/docs/guide/>

-   **RStudio Desktop** incluye una versión de Quarto en su instalación desde la versión 2022.07.01 pero conviene actualizarlo de forma independiente

## `r fontawesome::fa("laptop-code", "white")`️ Actividad 1 {background-color="#447099" transition="slide-in"}

<br> 

- Descargue la última versión de [Quarto](https://quarto.org/docs/get-started/)

<br> 

- Instale el software en su equipo local

<br> 

- Verifique la instalación ejecutando `quarto --version` en la Terminal (algo más completo es chequear con `quarto check`)


## Otras características

<br>

- Tiene múltiples formatos modernos de salidas unificado la funcionalidad de muchos paquetes del ecosistema R Markdown (rmarkdown, bookdown, distill, xaringan, etc.)

- Se pueden renderizar los documentos viejos `.rmd` (RMarkdown) o `.ipynb` (cuadernos jupyter de python) con Quarto.

- Viene incluido en otros editores como VS Code

- Soporta `htmlwidgets` en R y Jupyter widgets para Python/Julia ademmas de Observable JS

## Por qué usar Quarto en lugar de RMarkdown?

<br>

. . . 

- Quarto no es muy diferente a **RMarkdown** pero vendría a ser su versión 2.0

. . .

- Posee mejor accesibilidad y funciones más completas listas para usar

. . .

- **RMarkdown** aún tiene soporte pero todas las novedades y mejoras se están desarrollando solo para `Quarto`

. . .

- Si en el futuro incorporas algún otro lenguaje de programación/análisis podes seguir utilizandolo

. . .

- Te permite colaborar con otrxs compañerxs que utilizan **Python** u otro lenguaje

. . .

- Podes elegir otros editores y `Quarto` seguirá funcionando


## El universo de Quarto es enorme

![](images/Captura4.PNG){.absolute top="200" left="120" width="1500"}

## `r fontawesome::fa("laptop-code", "white")`️ Actividad 2  {background-color="#447099" transition="slide-in"}

<br> 

- Desde RStudio cree un documento HTML nuevo de Quarto 
  - Nombrelo como desee
- Explore el menú y sus elementos visuales en el modo **Visual**
  - Explicamos las partes de la demo incluída
  - Incorpore una nota al pie (*footnote*)
  - Incorpore un bloque de cita (*blockquote*)
- Cambie al modo **Source** y visualice el documento
- Renderice y vea los resultados

## Archivo `.qmd` {.smaller}

. . .

Al igual que los **.Rmd** de **RMarkdown** el archivo fuente de `Quarto` es de texto plano

. . .

Tiene una cabecera `YAML` con metadatos 


:::: {.columns style="font-size: 50px;"}

::: {.column width="45%"}

``` yaml
format: html
engine: knitr
```

:::

::: {.column width="55%"}

``` yaml
format: html
engine: jupyter
```

:::

::::

. . . 

Suele tener código incluido



:::: {.columns style="font-size: 50px;"}

::: {.column width="45%"}

````code
```{{r}}
library(dplyr)
mtcars |> 
  group_by(cyl) |> 
  summarize(mean = mean(mpg))
```
````

:::

::: {.column width="55%"}

````code
```{{python}}
from siuba import *
(mtcars
  >> group_by(_.cyl)
  >> summarize(avg_mpg = _.mpg.mean()))
```
````

:::

::::

. . .

Y texto narrativo

::: {style="font-size: 50px;"}
``` markdown
# Cabecera 1
Esto es texto en **negrita**, esto en *itálica* y esta otra una 
![imagen](image.png){fig-alt="Texto alternativo para esta imagen"}.
```

:::

## Metadatos: YAML

. . . 

<br>

- Los metadatos que se definen en el encabezado YAML que todos los archivos `.qmd` tienen son procesados en muchas etapas del renderizado y puede influir en el documento final de varias formas. 

. . . 

- Siempre se colocan al principio del documento y lo lee **Pandoc**, **Quarto** y **knitr**. 

. . . 

- En su recorrido, la información que contiene suele afectar el código, el contenido y el proceso de renderizado.

. . . 

- Muchas de las opciones de código YAML para Quarto se pueden encontrar en su [documentación](https://quarto.org/docs/reference/)  

## Texto y otros elementos 

. . . 

<br>

- `Quarto` se basa en **Pandoc** y utiliza su variación de [Markdown](https://es.wikipedia.org/wiki/Markdown) como sintaxis para documentos. 

. . . 

- El **Markdown** de Pandoc es una versión ampliada y ligeramente revisada de la sintaxis Markdown de [John Gruber](https://en.wikipedia.org/wiki/John_Gruber).

. . . 

- Markdown es un lenguaje de marcas sencillo diseñado para ser fácil de escribir y, lo que es más importante, fácil de leer.

. . . 

- Es el mismo que se utiliza en el formato anterior de RMarkdown (archivos .Rmd)

## Código

. . . 

- El código se puede insertar a través de chunks (fragmentos) en distintos lenguajes

````code
```{{r}}
#| Aquí van los metadatos con las opciones de ejecución

Aquí va el código
```
````
. . . 

- Las opciones de ejecución del código incluido dentro de estos fragmentos se realiza mediante metadatos con el formato #|

. . . 

- Se pueden definir opciones de salida, figura, procesado, etc. Ver [guía](https://quarto.org/docs/computations/execution-options.html).

. . . 

- También se puede incluir [código en línea](https://quarto.org/docs/computations/inline-code.html) en el texto. 

````code
```{{r}}
radio <- 5
```
````
El radio del circulo es \`\{r\} radio\`

## Algunos ejemplos

- [HTML paginado -estilo Tufte-](https://quarto-dev.github.io/quarto-gallery/page-layout/tufte.html)

- [Presentación revealjs](https://apreshill.github.io/palmerpenguins-useR-2022/)

- [Libro web](https://r4csr.org/)

- [Sitio web](https://sta210-s22.github.io/website/)

- [Documentos interactivos -shiny-](https://jjallaire.shinyapps.io/diamonds-explorer/)

- [Tableros](https://mine-cetinkaya-rundel.github.io/ld-dashboard/)