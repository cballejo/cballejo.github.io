---
title: "An谩lisis multinivel aplicado a epidemiolog铆a"
subtitle: "Unidad 1"
format: 
  revealjs:
    slide-number: true
    theme: simple
    css: styles.css
    logo: logo_INE.PNG
    footer: "Instituto Nacional de Epidemiolog铆a"
editor: visual
---

## Repaso sobre regresi贸n

::: incremental
-   M茅todo probabilistico que permite modelar la relaci贸n entre dos o m谩s variables.

-   Posee un componente sistem谩tico y un componente aleatorio (error / residuos)

-   La ecuaci贸n de un modelo de regresi贸n simple es: $y = \beta_0 + \beta_1x_1 + \epsilon$

-   A la variable $y$ se la denomina dependiente y a la variable $x$ , independiente.
:::

## Repaso sobre regresi贸n

-   El t茅rmino $\epsilon$ es conocido como el "error" y contiene la variabilidad de la variable dependiente no explicada por la(s) variable(s) independiente(s).

::: incremental
-   Dos posibles objetivos:

    -   **Explicativo**: ajustar un modelo para explicar las interrelaciones entre un conjunto de variables.

    -   **Predictivo**: ajustar un modelo a un conjunto de datos observados y luego usar ese modelo para hacer predicciones sobre un resultado a partir de un nuevo conjunto de variables explicativas
:::

## Regresi贸n lineal

-   La variable respuesta es cuantitativa continua.

-   La estimaci贸n se basa en el m茅todo de m铆nimos cuadrados (minimizaci贸n del error cuadr谩tico medio) - ver [Wiki](https://es.wikipedia.org/wiki/M铆nimos_cuadrados)

-   Se consideran 4 supuestos sobre los residuos del modelo para un correcto ajuste: *linealidad, independencia, normalidad* y *homocedasticidad.*

-   Funci贸n en R: ***lm()***

## Terminolog铆a

::: columns
::: {.column width="50%"}
<br> ***Variable dependiente***: respuesta, salida, resultado.

<br>

***Variable independiente***: explicativa, predictora, regresor.
:::

::: {.column width="50%"}
![](images/Regresion1.png){width="90%"}
:::
:::

## Ajuste

![](images/Regresion2.png){fig-align="center"}

## Supuestos

::: {layout-ncol="2"}
![](images/Regresion3a.PNG){width="120%"}

![](images/Regresion3b.PNG)
:::

## Ecuaci贸n lineal {.smaller}

$$
y = \beta_0 + \beta_1x_1 + \beta_2x_2 + \epsilon
$$

Donde:

$y$ = variable dependiente (respuesta)

$x_1$ = variable independiente (explicativa - predictora)

$x_2$ = variable independiente (explicativa - predictora)

$\beta_0$ = intercepto (ordenada al origen)

$\beta_1$ = coeficiente de la variable x1 (pendiente de la recta)

$\beta_2$ = coeficiente de la variable x2

$\epsilon$ = residuos (error - componente aleatorio)

## Regresi贸n m煤ltiple {.smaller}

::: panel-tabset
## Gr谩fico

![](images/Regresion4a.PNG){fig-align="center" width="575"}

## Salida en R

![](images/Regresion4b.PNG){fig-align="center" width="622"}
:::

## Coeficiente de determinaci贸n

-   $R^2$ es una medida de qu茅 tan cerca est谩n los datos de la recta ajustada.

-   Se conoce como coeficiente de determinaci贸n y representa la proporci贸n de la variable dependiente que se explica por la(s) variable(s) explicativa(s).

-   Si es 0 indica que ninguna de las variaciones en la dependiente se explica por la explicativa.

-   Si es 1 indica que el modelo explica toda la variabilidad en la dependiente (la recta sigue exactamente los puntos de datos).

## Coeficiente de determinaci贸n en R

-   El lenguaje R proporciona el $R^2$ y el $R^2$ ajustado.

-   Este 煤ltimo incluye una penalizaci贸n cuantas m谩s variables explicativas se incluyan en el modelo. Entonces, si el modelo incluye variables que no contribuyen a la descripci贸n de la variable dependiente, el $R^2$ ajustado ser谩 menor.

## Rol de las variables independientes {.smaller}

::: panel-tabset
## DAGs

![](images/Regresion5.png){fig-align="center" width="75%"}

## Detalles

**Posibles caminos causales**

En el primero, fumar no est谩 asociado con el resultado (presi贸n arterial) ni con nuestra variable explicativa de inter茅s (consumo de caf茅).

En el segundo, fumar se asocia con presi贸n arterial elevada, pero no con el consumo de caf茅. Este es un ejemplo de modificaci贸n de efecto (interacci贸n).

En el tercero, fumar se asocia con presi贸n arterial elevada y con el consumo de caf茅. Este es un ejemplo de confusi贸n.
:::

## Interacci贸n {.smaller .scrollable}

::: panel-tabset
## Gr谩fico

![](images/Regresion6.png){fig-align="center"}

## Explicaci贸n

La modificaci贸n del efecto ocurre cuando el tama帽o del efecto de la variable explicativa de inter茅s (exposici贸n) sobre el resultado (variable dependiente) difiere seg煤n el nivel de una tercera variable. Dicho de otra manera, se trata de una situaci贸n en la que una variable explicativa modifica diferencialmente (positiva o negativamente) el efecto observado de otra variable explicativa sobre el resultado.

驴Qu茅 significa esto en el ejemplo? Bueno, puede ser biol贸gicamente plausible que el efecto de fumar sobre la presi贸n arterial aumente multiplicativamente debido a una interacci贸n qu铆mica entre el humo del cigarrillo y la cafe铆na, por ejemplo.
:::

## Confusi贸n {.smaller .scrollable}

::: panel-tabset
## Gr谩fico

![](images/Regresion7.png){fig-align="center"}

## Explicaci贸n

La confusi贸n es una situaci贸n en la que la asociaci贸n entre una variable explicativa (exposici贸n) y el resultado (variable dependiente) se distorsiona por la presencia de otra variable explicativa.

Si solo ajustamos la presi贸n arterial por el consumo de caf茅, entonces podemos concluir err贸neamente que existe una relaci贸n entre el consumo de caf茅 y la presi贸n arterial.

Si incluimos el factor de confusi贸n en el modelo al agregar fumar, la verdadera relaci贸n se hace evidente. Dos l铆neas planas paralelas que indican que el caf茅 no tiene efecto sobre la presi贸n arterial, pero s铆 una relaci贸n entre fumar y la presi贸n arterial. Este procedimiento se conoce como ajuste de factores de confusi贸n.
:::

## Regresi贸n Lineal Generalizada

-   Extensi贸n de los modelos lineales que permiten utilizar distribuciones de errores no normales.

-   Para el ajuste implementa la estimaci贸n de maxima verosimilitud - ver [Wiki](https://es.wikipedia.org/wiki/M%C3%A1xima_verosimilitud)

-   Se caracterizan por tener una estructura con tres elementos:

    1.  Una distribuci贸n (componente aleatorio)
    2.  Un componente sist茅mico lineal
    3.  Una funci贸n de enlace (logit, log, etc)

## Regresi贸n log铆stica

-   **Variable dependiente:** categ贸rica binaria (si - no)

-   **Componente aleatorio:** Distribuci贸n binomial

-   **Componentes sist茅micos (predictores lineales):** $log(Odds) = X_i\beta$

-   **Funci贸n de enlace:** $logit = g(\mu_i) = log(\frac{\mu_}{(1\mu_})$

-   **Conversi贸n:** exp(coeficiente) = OR

## Ejemplo log铆stica {.smaller .scrollable}

::: panel-tabset
## Gr谩fico

![](images/Logistica_A.png){fig-align="center" width="70%"}

## Salida en R

![](images/Logistica_B.png){fig-align="center" width="80%"}
:::

## Regresi贸n Poisson

-   **Variable dependiente:** conteos o tasas (offset)

-   **Componente aleatorio:** Distribuci贸n de Poisson

-   **Componentes sist茅micos (predictores lineales):** $ln(\lambda_i) = X_i\beta$

-   **Funci贸n de enlace:** $log = g(\lambda_i) = ln(\lambda_i)$

-   **Conversi贸n:** exp(coeficiente) = RR / raz贸n de densidad de incidencia
